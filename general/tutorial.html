
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>miniML Tutorial &#8212; miniML documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'general/tutorial';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Loading data" href="loading_data.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="miniML documentation - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="miniML documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    miniML documentation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">USING MINIML</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">miniML Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading_data.html">Loading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_resampling.html">Using existing models for out-of-sample data</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_analysis.html">Batch analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">miniML models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GUI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_intro.html">The miniML GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_display.html">Using the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_load.html">Loading data using the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_analyze.html">Analyze a recording using the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_eventview.html">The EventViewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_save.html">Save analysis results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_auto_settings.html">miniML Auto Settings Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui_settings.html">miniML Settings</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MODEL TRAINING</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../training/model_training.html">miniML model training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/full_training.html">Training a full model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/TL_training.html">Training a transfer learning model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/tutorial_TL_model.html">Using a transfer learning model</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/delvendahl/miniML" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/delvendahl/miniML/issues/new?title=Issue%20on%20page%20%2Fgeneral/tutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/general/tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>miniML Tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up">Setting up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-miniml">Running miniML</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-results">Inspect the results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-results-to-file">Save results to file</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="miniml-tutorial">
<h1>miniML Tutorial<a class="headerlink" href="#miniml-tutorial" title="Link to this heading">#</a></h1>
<section id="setting-up">
<h2>Setting up<a class="headerlink" href="#setting-up" title="Link to this heading">#</a></h2>
<p>We begin by importing the required parts of the miniML package. We need to add the path to the miniML core folder to the Python path, and import the MiniTrace and EventDetection classes from miniML. Then, we also import the miniML_plots class from miniML_plot_functions to plot the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../core/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">miniML</span> <span class="kn">import</span> <span class="n">MiniTrace</span><span class="p">,</span> <span class="n">EventDetection</span>
<span class="kn">from</span> <span class="nn">miniML_plot_functions</span> <span class="kn">import</span> <span class="n">miniML_plots</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-miniml">
<h2>Running miniML<a class="headerlink" href="#running-miniml" title="Link to this heading">#</a></h2>
<p>For the actual data analysis, we first need to load the data and create a miniML <em>MiniTrace</em> object. The <em>MiniTrace</em> class has different methods for loading from files.Currently accepted file formats are HDF5, Axon ABF and HEKA DAT.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Loading data is described in the <a class="reference internal" href="loading_data.html"><span class="std std-doc">Loading data</span></a> notebook</p>
</div>
<p>In this example, we load the dataset [‘mini_data’] from the provided example .h5 file. The data can be scaled for convenience (e.g., to pA). This is optional and has no impact on the analysis. Provide the sampling interval (in seconds, e.g., <em>sampling=1e-5</em>) of the recording if the sampling rate is not 50 kHz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../../example_data/gc_mini_trace.h5&#39;</span>
<span class="n">scaling</span> <span class="o">=</span> <span class="mf">1e12</span>
<span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pA&#39;</span>

<span class="c1"># load from h5 file</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">MiniTrace</span><span class="o">.</span><span class="n">from_h5_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                               <span class="n">tracename</span><span class="o">=</span><span class="s1">&#39;mini_data&#39;</span><span class="p">,</span>
                               <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">,</span>
                               <span class="n">sampling</span><span class="o">=</span><span class="mf">2e-5</span><span class="p">,</span>
                               <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Data can also be loaded from, e.g., Axon binary files (.abf):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../../example_data/gc_mini_trace.abf&#39;</span>
<span class="n">scaling</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pA&#39;</span>

<span class="c1"># load from ABF file</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">MiniTrace</span><span class="o">.</span><span class="n">from_axon_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                                 <span class="n">channel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                 <span class="n">scaling</span><span class="o">=</span><span class="n">scaling</span><span class="p">,</span>
                                 <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s plot the loaded data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c5ff5b2bd61942f7e14eec47286c33036de7dbfe6429b828d4e0b4c9aa7be7a4.png" src="../_images/c5ff5b2bd61942f7e14eec47286c33036de7dbfe6429b828d4e0b4c9aa7be7a4.png" />
</div>
</div>
<p>Next, we need to create and initialize a miniML <em>EventDetection</em> object. Required arguments are a miniML MiniTrace object to work on and the path to a miniML model file. Optionally, the threshold for event detection can be adjusted (range, 0–1). The batch_size parameter can be changed to reduce runtime when running on a GPU (caveat: too large batch sizes can cause poor model prediction performance).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">win_size</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;negative&#39;</span>

<span class="n">detection</span> <span class="o">=</span> <span class="n">EventDetection</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
                           <span class="n">model_path</span><span class="o">=</span><span class="s1">&#39;../../models/GC_lstm_model.h5&#39;</span><span class="p">,</span>
                           <span class="n">window_size</span><span class="o">=</span><span class="n">win_size</span><span class="p">,</span>
                           <span class="n">model_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                           <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
                           <span class="n">event_direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                           <span class="n">compile_model</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model loaded from ../../models/GC_lstm_model.h5
</pre></div>
</div>
</div>
</div>
<p>To detect events, we have to call the <code class="docutils literal notranslate"><span class="pre">detect_events()</span></code> method. Set the eval flag to <strong>False</strong> if you do not want to analyse the detected events. For the downstream analysis, four parameters can be adjusted:</p>
<ul class="simple">
<li><p><strong>peak_w</strong>: int, default = 5. Determines the minimum width of peaks in the prediction trace.</p></li>
<li><p><strong>rel_prom_cutoff</strong>: float, default = 0.25. In case multiple peaks in the first derivative are found, this value determines the minimum prominence (relative to the largest prominence) a peak needs to have to be considered an event. For preparations that have no or little to no overlapping events, this value can be set to 1, to find only single peaks.</p></li>
<li><p><strong>convolve_win</strong>: int, default = 20. Size of the Hann window used to filter the data for detection of event location and event analysis.</p></li>
<li><p><strong>gradient_convolve_win</strong>: int, default = 2*convolve_win (40 here): Size of the Hann window used to filter the first derivative of the filtered data to determine event locations.</p></li>
</ul>
<p>For other data than the one shown here, <strong>convolve_win</strong> and <strong>gradient_convolve_win</strong> are the most crucial to adjust. To check the filter settings, the <code class="docutils literal notranslate"><span class="pre">plot_gradient_search()</span></code> method (see “Inspect the results” section below) can be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detection</span><span class="o">.</span><span class="n">detect_events</span><span class="p">(</span><span class="nb">eval</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">peak_w</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">rel_prom_cutoff</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                        <span class="n">convolve_win</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                        <span class="n">gradient_convolve_win</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>586/586 - 12s - 12s/epoch - 21ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Event statistics:
-------------------------
    Number of events: 43
    Average score: 0.958
    Event frequency: 0.3583 Hz
    Mean amplitude: -9.6757 pA
    Median amplitude: -9.6035 pA
    Std amplitude: 4.2933 pA
    CV amplitude: 0.444
    Mean charge: -0.01395 pC
    CV charge: 0.484
    Mean 10-90 risetime: 0.353 ms
    Mean half decay time: 0.770 ms
    Mean half-width: 1.967 ms
    Tau decay: 1.157 ms
-------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect-the-results">
<h2>Inspect the results<a class="headerlink" href="#inspect-the-results" title="Link to this heading">#</a></h2>
<p>After the event detection and analysis, we can create some plots. MiniML includes several plotting methods that can be found in the <em>miniML_plots</em> class in <code class="docutils literal notranslate"><span class="pre">miniML_plot_functions.py</span></code>. A miniML <em>EventDetection</em> object has to be passed as data argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_prediction()</span></code> shows the model inference trace, optinally together with the data and marked events. Note that we plot a filtered version of the trace in this example.</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_event_overlay()</span></code> creates a figure with all detected events overlaid, as well as their average and the exponential fit on the average.</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_event_histogram()</span></code> plots a histogram of event amplitudes (optional: inter-event-intervals). Set <em>cumulative=True</em> for a cumulative probability plot.</p>
<p><code class="docutils literal notranslate"><span class="pre">plot_gradient_search()</span></code> plots the event location search. Top pannel contains the prediction, middle pannel the data and filtered data and lower panel the first derivative and filtered first derivative. Useful if the default filter settings (see above) are not appropriate for your data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MiniPlots</span> <span class="o">=</span> <span class="n">miniML_plots</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">detection</span><span class="p">)</span>

<span class="n">MiniPlots</span><span class="o">.</span><span class="n">plot_prediction</span><span class="p">(</span><span class="n">include_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_filtered_prediction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_filtered_trace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_event_params</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">MiniPlots</span><span class="o">.</span><span class="n">plot_event_overlay</span><span class="p">()</span>
<span class="n">MiniPlots</span><span class="o">.</span><span class="n">plot_event_histogram</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">MiniPlots</span><span class="o">.</span><span class="n">plot_gradient_search</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/303f0d95b4140469703b05af4cc0fa68185f2500b13e016b0d9e7eaa955271d1.png" src="../_images/303f0d95b4140469703b05af4cc0fa68185f2500b13e016b0d9e7eaa955271d1.png" />
<img alt="../_images/689ef27e1b4e68805bb8a5f953dced2bf13378b07fb0378430774e92d6f98652.png" src="../_images/689ef27e1b4e68805bb8a5f953dced2bf13378b07fb0378430774e92d6f98652.png" />
<img alt="../_images/c3399308e2e17d181e7915c78311f4ee35705f3f9955f592628f890ef84d3a2f.png" src="../_images/c3399308e2e17d181e7915c78311f4ee35705f3f9955f592628f890ef84d3a2f.png" />
<img alt="../_images/5a15b104abba7a9249e8f55fec6126a964ddfb10c6db7943fa3645dfdb9eccc6.png" src="../_images/5a15b104abba7a9249e8f55fec6126a964ddfb10c6db7943fa3645dfdb9eccc6.png" />
</div>
</div>
</section>
<section id="save-results-to-file">
<h2>Save results to file<a class="headerlink" href="#save-results-to-file" title="Link to this heading">#</a></h2>
<p>Finally, we can save the results to file for later use. The <code class="docutils literal notranslate"><span class="pre">save_to_pickle()</span></code> method saves the data in pickle format (essentially a python dictionary). If desired, the mini trace and the generated prediction trace can be saved as well. Note that this will increase file size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detection</span><span class="o">.</span><span class="n">save_to_pickle</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../results/gc_mini_trace_results.pickle&#39;</span><span class="p">,</span> 
                         <span class="n">include_prediction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                         <span class="n">include_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>events saved to ../results/gc_mini_trace_results.pickle
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">save_to_h5()</span></code> method saves the detected events and the individual event statistics to a specified HDF5 file. It also includes average results for amplitude, charge, frequency, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detection</span><span class="o">.</span><span class="n">save_to_h5</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../results/gc_mini_trace_results.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Events saved to ../results/gc_mini_trace_results.h5
</pre></div>
</div>
</div>
</div>
<p>In addition, results can be saved in a delimited text format using <code class="docutils literal notranslate"><span class="pre">save_to_csv()</span></code>. This methods takes a filename and saves two .csv files containing event population statistics and individual event statistics, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detection</span><span class="o">.</span><span class="n">save_to_csv</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../results/gc_mini_trace_results.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>events saved to ../results/gc_mini_trace_results_avgs.csv and ../results/gc_mini_trace_results_individual.csv
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Refer to the documentation in the <code class="docutils literal notranslate"><span class="pre">miniML.py</span></code> file for more details on the saving methods.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./general"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="loading_data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Loading data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up">Setting up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-miniml">Running miniML</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-results">Inspect the results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-results-to-file">Save results to file</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PS O'Neill & I Delvendahl
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>